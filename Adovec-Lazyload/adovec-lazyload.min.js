"use strict";var _slicedToArray=function(){function t(t,n){var e=[],r=!0,i=!1,o=void 0;try{for(var c,a=t[Symbol.iterator]();!(r=(c=a.next()).done)&&(e.push(c.value),!n||e.length!==n);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&a.return&&a.return()}finally{if(i)throw o}}return e}return function(n,e){if(Array.isArray(n))return n;if(Symbol.iterator in Object(n))return t(n,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();!function(t,n){var e={isProto:function(t,n){return{}.toString.call(t)==="[object "+n+"]"},isInstanceOf:function(t,n){var e=this,r=this.isProto;return r(n,"Function")?n.name?r(t,n.name):n(t):r(n,"String")?r(t,n):n.some(function(n){return e.isInstanceOf(t,n)})},isClassOf:function(t){var n=this;return function(e){return n.isInstanceOf(t,e)}},extend:function(){var t,n,e,r,i,o=this.isInstanceOf.bind(this),c=this.extend.bind(this),a=0,s=!1;for(o(arguments[0],Boolean)&&(a=1,s=arguments[0]),i=arguments.length-1;i>a;i--)if(e=arguments[i-1],r=arguments[i],o(r,[Object,Array]))for(var u in r)if(t=r[u],s&&o(t,[Object,Array])){n=o(t,Object)?{}:[];var l=c(s,n,t);e[u]=l}else e[u]=r[u];else e=r;return e},deepExtend:function(){for(var t=arguments.length,n=Array(t),e=0;e<t;e++)n[e]=arguments[e];return this.extend.apply(this,[!0].concat(n))},render:function(t,n,e){var r=function(t){return"with(data || {}) {return ("+t+");}"};return t.replace(new RegExp((e||["{{","}}"]).join("\\s*?(.*?)\\s*?"),"gm"),function(t,e){return new Function("data",r(e))(n)})},partition:function(t,n){var e=[[],[]];return t.forEach(function(t){return e[1^n(t)].push(t)}),e},debounce:function(t,n){var e=void 0;return function(){for(var r=arguments.length,i=Array(r),o=0;o<r;o++)i[o]=arguments[o];clearTimeout(e),e=setTimeout(function(){return t.apply(void 0,i)},n)}},throttle:function(t,n){var e=0,r=void 0;return function(){for(var i=arguments.length,o=Array(i),c=0;c<i;c++)o[c]=arguments[c];var a=new Date;clearTimeout(r),a-e<n?r=setTimeout(function(){return t.apply(void 0,o)},n):(e=a,t.apply(void 0,o))}}},r=function(n){var r={load:!0,placeHolder:"",renderPlaceHolder:!1,selector:"img",changePlaceHolder:!0,prefix:"adovec",onscrolledimg:null,delim:["{{","}}"],throttleRate:200};this.alive=!1;var i=this.options=e.deepExtend({},r,n);this.setOption=function(t){return this.options=e.deepExtend({},r,n),this},this.load=function(){this.alive&&this.destroy(),this.alive=!0,this.pics=document.querySelectorAll(i.selector),this.options.changePlaceHolder&&this.pics.forEach(function(t){var n=i.prefix+"-src";t.getAttribute(n)||t.setAttribute(n,t.src),t.src=i.changePlaceHolder?e.render(i.placeHolder,t,i.delim):i.placeHolder}),this.handler(),addEventListener("scroll",this.handler)},this.handler=e.throttle(function(n){var r=this,i=document.documentElement.scrollTop+t.innerHeight;return new Promise(function(t){t(e.partition(r.pics,function(t){return i>=t.y}))}).then(function(t){var n=_slicedToArray(t,2),e=n[0],i=n[1];return e.forEach(function(t){return t.src=t.getAttribute(r.options.prefix+"-src")||t.src}),r.pics=i}).then(function(t){return t.length||r.destroy(),t}).then(function(t){return r.options.onscrolledimg&&r.options.onscrolledimg(t)})}.bind(this),i.throttleRate),this.destroy=function(){this.alive=!1,removeEventListener("scroll",this.handler)},this.options.load&&this.load()};r.of=function(t){return new r(t)},r.utils=e,t.AdovecLazyLoad=r}(window);