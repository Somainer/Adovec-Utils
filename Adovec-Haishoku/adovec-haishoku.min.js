"use strict";!function(t,e){var n=function(t,e){var n=document.createElement("canvas");return n.setAttribute("width",t),n.setAttribute("height",e),n.getContext("2d")},r=function(t,e){var r=new Image,o=t.src||t;"data:"!==o.substring(0,5)&&(r.crossOrigin="Anonymous"),r.onload=function(){var t=n(r.width,r.height);t.drawImage(r,0,0);var o=t.getImageData(0,0,r.width,r.height);e&&e(o.data)},r.src=o},o=function(t){return["rgb(",t,")"].join("")},i=function(t){var e=[];for(var n in t)e.push(c(n,t[n]));return e.sort(function(t,e){return e.count-t.count}),e},a=function(t,e){if(t.length>e)return t.slice(0,e);for(var n=t.length-1;n<e-1;n++)t.push(c("0,0,0",0));return t},c=function(t,e){return{name:o(t),count:e}},u={};u.colors=function(t,e){e=e||{};var n=e.exclude||[],c=e.paletteSize||10;r(t,function(t){for(var r={},u="",l=[],s=0;s<t.length;s+=4)l[0]=t[s],l[1]=t[s+1],l[2]=t[s+2],u=l.join(","),-1===l.indexOf(void 0)&&0!==t[s+3]&&-1===n.indexOf(o(u))&&(r[u]=u in r?r[u]+1:1);if(e.success){var f=a(i(r),c+1);e.success({dominant:f[0].name,secondary:f[1].name,palette:f.map(function(t){return t.name}).slice(1)})}})},t.adovecHaishoku=t.adovecHaishoku||{forEach:function(t,e){for(var n in t)e(t[n],n,t)},extend:function(){var t=function(t){var e=Object.prototype.toString;return function(){return e.call(arguments[0])==="[object "+t+"]"}},e=t("Object"),n=t("Array"),r=t("Boolean");return function t(){var o,i,a,c,u,l=0,s=!1;for(r(arguments[0])&&(l=1,s=arguments[0]),u=arguments.length-1;u>l;u--)if(a=arguments[u-1],c=arguments[u],e(c)||n(c)){console.log(c);for(var f in c)if(o=c[f],s&&(e(o)||n(o))){i=e(o)?{}:[];var d=t(s,i,o);a[f]=d}else a[f]=c[f]}else a=c;return a}}(),deepExtend:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.extend.apply(this,[!0].concat(e))},splitRGB:function(t){return t.match(/\d+/g)},getYIQ:function(t){var e=this.splitRGB(t);return(299*e[0]+587*e[1]+114*e[2])/1e3},getNormalizedTextColor:function(t,e,n){return this.getYIQ(t)>=128?n:e},apply:function(t){var e={image:null,changeText:!1,textColors:{light:"#fff",dark:"#000"},exclude:["rgb(0,0,0)"],target:"body",text:null},n=this.deepExtend({},e,t);console.log(n);var r=n.image,o=this,i=document.querySelectorAll.bind(document);u.colors(r,{paletteSize:20,exclude:n.exclude,success:function(t){var e=o.splitRGB(t.dominant)?t.dominant:t.palette.find(function(t){return o.splitRGB(t)})||"rgb(255,255,255)";i(n.target).forEach(function(t){t.style.transition="background-color 1800ms ease",t.style.backgroundColor=e}),n.changeText&&i(n.text||n.target).forEach(function(t){t.style.transition="color 1800ms ease",t.style.color=o.getNormalizedTextColor(e,n.textColors.light,n.textColors.dark)})}})}}}(window);